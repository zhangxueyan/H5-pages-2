function detectUA(){var e={"workstation-win":/\(Windows\sNT.*\)/i,"workstation-mac":/\(Macintosh;\sIntel\sMac\sOS\sX.*\)/i,"mobile-aos":/(\(Linux.*Android.*\)|\(Android.*Mobile.*\))/i,"mobile-ios":/\(iPhone.*CPU.*iPhone.*OS.*like.*Mac.*OS.*X/i},t={ios:{weixin:/Mobile\/.*MicroMessenger\//i,qq:/Version\/.*MQQBrowser\/.*Mobile\/.*Safari\//i,baidu:/Version\/.*Mobile\/.*Safari\/.*baidubrowser\//i,uc:/Mobile\/.*UCBrowser\//i,firefox:/FxiOS\/.*Mobile\/.*Safari\//i,sougou:/Mobile\/.*SogouMobileBrowser\//i,aoyou:/Version\/.*Mobile\/.*Safari\/.*MXiOS\//i,360:/Version\/.*Mobile\/.*Safari\/.*QHBrowser\//i,opera:/Mobile\/[0-9|a-z|A-Z|\.]+$/i,safari:/Version\/.*Mobile\/.*Safari\//i,chrome:/CriOS\/.*Mobile\/.*Safari\//i,liebao:/Version\/.*Mobile\/.*Safari\/.*LieBao/i},aos:{weixin:/AppleWebKit.*Version\/.*Chrome\/.*Mobile.*MQQBrowser.*\/.*Safari\/.*MicroMessenger\//i,qq:/AppleWebKit.*Version\/.*Chrome\/.*MQQBrowser\/.*Mobile\sSafari\//i,baidu:/AppleWebKit.*Version\/.*Chrome\/.*Mobile\sSafari\/.*baidubrowser\//i,uc:/AppleWebKit.*Version\/.*UCBrowser\/.*Mobile\sSafari\//i,firefox:/Gecko\/.*Firefox\//i,sougou:/AppleWebKit.*Chrome\/.*Mobile\sSafari\/.*SogouMobileBrowser/i,SogouSearch:/AppleWebKit.*Version\/.*Chrome\/.*Mobile\sSafari\/.*SogouSearch/i,MiuiBrowser:/AppleWebKit.*Version\/.*Chrome\/.*Mobile\sSafari\/.*MiuiBrowser/i,xiao_MiuiBrowser:/AppleWebKit.*Version\/.*Mobile\sSafari\/.*MiuiBrowser/i,vivo_Y_baiduboxapp:/vivo\sY.*AppleWebKit.*Version\/.*Chrome\/.*Mobile\sSafari\/.*baiduboxapp/i,baiduboxapp:/AppleWebKit.*Version\/.*Chrome\/.*Mobile\sSafari\/.*baiduboxapp/i,vivo_Y_built_in:/vivo\sY.*AppleWebKit.*Version\/.*Chrome\/.*Mobile\sSafari\//i,"360s":/AppleWebKit.*Version\/.*Chrome\/.*Mobile\sSafari\/.*360browser/i,aoyou:/AppleWebKit.*Version\/.*Chrome\/.*Mobile\sSafari\/.*MxBrowser\//i,opera:/AppleWebKit.*Version\/.*OPR\/.*Mobile Safari\//i,liebao:/AppleWebKit.*Version\/.*Chrome\/.*Mobile\sSafari\/.*LieBao/i,safari:/AppleWebKit.*Version\/.*Chrome\/.*Mobile\sSafari\//i,chrome:/AppleWebKit.*(KHTML.*)\sChrome\/.*Mobile\sSafari\//i,huawei:/AppleWebKit.*Version\/.*Mobile\sSafari\//i}},i=window.navigator.userAgent||"",n={};n.ua=i;for(var a in e){if(e[a].test(i)){n.device=a,n.deviceValue=e[a];break}n.device="unknow"}if("mobile-ios"===n.device)for(var s in t.ios){if(t.ios[s].test(i)){n.browser=s,n.browserValue=t.ios[s];break}n.browser="unknow"}else if("mobile-aos"===n.device)for(var s in t.aos){if(t.aos[s].test(i)){n.browser=s,n.browserValue=t.aos[s];break}n.browser="unknow"}return n}function tryToDecodeUrl(e){var t,i,n=0;if(!e)return"";for(t=e,i=e;3>n;){if(i=decodeURIComponent(t),i===t)return i;n+=1,t=i}return i}function addPageTilte(){var e={title:document.title,url:location.href};try{if(isThrough)return}catch(t){}window.history.pushState(e,"chat","")}function globalRequestChat(e,t){isMiniMode()?callOpenMiniChat(e):callOpenMaxChat(e,null,t);var i={};i.ele_name=e,i.e_id=mantis.e_id,i.type="CHAT",sendClick(i)}function postInit(){var e=detectUA(),t="";e&&e.ua?(t=shortMsg(e.ua||"",2e3),mantis.browser={ua:t,name:e.browser,type:e.device}):(t=window.navigator.userAgent||"",t=shortMsg(t,2e3),mantis.browser={ua:t}),checkLpByReferAndCookie();var i=parseLandingPage(mantis.landPageUrl);i&&i.siteId?(mantis.siteId=i.siteId,mantis.stag=i.stag):(mantis.siteId=0,mantis.stag=null),mantis.siteId?Cookies.set("mantis_sid"+mantis.companyId,mantis.siteId,{expires:in30Minutes,domain:mantis.rootDomain}):mantis.sidInCookie||Cookies.remove("mantis_sid"+mantis.companyId),mantis.stag?Cookies.set("mantis_stag"+mantis.companyId,mantis.stag,{expires:in30Minutes,domain:mantis.rootDomain}):mantis.stagInCookie||Cookies.remove("mantis_stag"+mantis.companyId),mantis.ctag=getStag(mantis.landPageUrl);var n=Cookies.get("mantis"+mantis.companyId);if(n&&"undefined"!==n&&n.replace(/(^s*)|(s*$)/g,"").length>0){var a="@"+mantis.companyId;-1===n.indexOf(a)?(mantis.uid=createGuid()+"@"+mantis.companyId,Cookies.set("mantis"+mantis.companyId,mantis.uid,{expires:1e3,domain:mantis.rootDomain})):mantis.uid=n}else mantis.uid=createGuid()+"@"+mantis.companyId,Cookies.set("mantis"+mantis.companyId,mantis.uid,{expires:1e3,domain:mantis.rootDomain});sendPageInfo(),bindWindowEvent(),appendCustomizeClass(),appendCustomizeJS(),"false"===mantis.hideChatIcon&&initMinimize()}function getAdInfoFromCookie(){var e=Cookies.get("mantisrf"+mantis.companyId);if(e)try{return JSON.parse(decodeURIComponent(e))}catch(t){console.error("fail to parse the ad info")}return null}function checkLpByReferAndCookie(){var e=parseReferer(mantis.referer);if(e.ad)return mantis.parsedRefer=e,mantis.isLandingPage=!0,mantis.landPageUrl=mantis.url,mantis.lp_calc="REFER",setLPCookie(),void Cookies.set("mantisrf"+mantis.companyId,encodeURIComponent(JSON.stringify(e)),{expires:in30Minutes,domain:mantis.rootDomain});var t,i=getUrlVars(mantis.url);if(t=i.sid?i.sid:0)return mantis.isLandingPage=!0,mantis.landPageUrl=mantis.url,mantis.lp_calc="NO_AD_HAS_SID",void setLPCookie();var n=getAdInfoFromCookie();if(n&&n.ad){mantis.parsedRefer=n;var a=getLandingPageByCookie();if(a){mantis.landPageUrlInCookie=a,mantis.isLandingPage=!1;var s=retrieveSidFromCookie();s&&s.siteId&&(mantis.sidInCookie=s.siteId,mantis.stagInCookie=s.stag)}}}function retrieveSidFromCookie(){var e={},t=Cookies.get("mantis_sid"+mantis.companyId);t&&(e.siteId=t);var i=Cookies.get("mantis_stag"+mantis.companyId);return i&&(e.stag=i),e}function parseLandingPage(e){if(!e)return null;var t={},i=getUrlVars(e);if(t.siteId=i.sid?i.sid:0,i.stag){var n=i.stag.length;n>32&&(n=32),t.stag=mySubStr(i.stag,n)}else t.stag="";return t}function initAutoChat(){var e=mantis.chat.autoChatDelay;switch("undefined"==typeof mantis.chat.autoChatDelay&&(e=-1),isNaN(mantis.chat.autoChatDelay)&&(e=-1),e){case-1:try{"function"==typeof onManitsLoadComplete&&onManitsLoadComplete()}catch(t){}break;case 0:setTimeout(function(){globalRequestChat()},1e3);break;default:setTimeout(function(){globalRequestChat()},1e3*e)}}function bindWindowEvent(){$(window).blur(function(){"blur"!==mantis.status&&(mantis.status="blur",sendAlive("blur"),setupInactiveTTL())}),$(window).focus(function(){"focus"!==mantis.status&&(mantis.status="focus",sendAlive("focus"),setupActiveTTl())})}function loadPageParameter(){if(console.warn("no p found"),!mantis_init)return void console.error("Please init the mantis first");var e,t,i=mantis_init.cid,n=mantis_init.buid||3,a=mantis_init.chat.host,s=mantis_init.chat.port;mantis_init.t?(e=mantis_init.t.host,t=mantis_init.t.port):(e=mantis_init.chat.host,t=mantis_init.chat.port);var o=mantis_init.locationId||"",r=a||e,m=s||t||80;if(!i||!a||!s)return void console.info("please check host and port");var d=mantis_init.mode,c=mantis_init.sg,l=mantis_init.projectId,u=mantis_init.brand||"";mantis.chatAddr="http://"+a+":"+s+"/chat/",mantis.eAddr="http://"+e+":"+t+"/u/1.gif",mantis.resvAddr="http://"+r+":"+m,mantis.companyId=i,mantis.buId=n,l||(l=0),mantis.projectId=l,mantis.defaultSg=c,mantis.pc_page_chat_mode=d,mantis.locationId=o,mantis.brand=u,loadConfig()}function loadProbeCallBack(e){if(!e)return void console.error("no probe found");mantis_init={},mantis.probeUsed=!0,mantis.probe=e,mantis.companyId=e.companyId,mantis.buId=e.buId;var t=e.projectId;t||(t=0),mantis.projectId=t,mantis.defaultSg=e.defaultSvgId,mantis.chat.mbIframeHeight=e.mbIframeHeight||"85";var i=e.chatServer,n=e.chat_port||80,a=e.track_host||i,s=e.track_port||80,o=i||a,r=n||s||80;return mantis.chatAddr="http://"+i+":"+n+"/chat/",mantis.eAddr="http://"+a+":"+s+"/u/1.gif",mantis.resvAddr="http://"+o+":"+r,mantis.companyId&&i&&n?void loadConfig():void console.info("please check host and port")}function extractDomain(){var e=window.location.hostname.split("."),t=e.length;if(0===t||2>=t)return window.location.hostname;var i=e[t-1];return isNaN(i)?e.reverse().splice(0,t-1).reverse().join("."):window.location.hostname}function getProbeId(){for(var e="mantis.min.js",t=document.getElementsByTagName("script"),i=0;i<t.length;i++){var n=t[i].src;if(-1!==n.indexOf(e)){var a=n.lastIndexOf(e+"?");if(-1===a)return null;if(n=n.substring(a+(e.length+1))){var s=n.replace(/^\s+|\s+$/g,"");if(s)return s.replace(/#/g,"/")}return null}}}function loadProbe(e,t,i){$.support.cors=!0,$.ajax({dataType:"json",url:"http://probe.bjmantis.net/"+e+".json",crossDomain:!0,success:t,error:i})}function getStag(e){if(e){var t=e.match(/(#.+)\?/);if(t&&2===t.length)return t[1]}return""}function getTrackId(e){return e?e.trackId?e.trackId:e:""}function sendPageInfo(){if(mantis.e_id)return console.warn("repeat!!"),void initAutoChat();var e="false";mantis.isLandingPage&&(e="true");var t={uid:mantis.uid,company:mantis.companyId,buId:mantis.buId,page_title:mantis.title,url:window.location.href,refer:mantis.referer,media:isMobile.any?"mobile":"pc",site_id:mantis.siteId,stag:mantis.stag,mwd:mantis.parsedRefer,browser:mantis.browser,lp_id:getLPId(),is_lp:e,lp:mantis.landPageUrl,lpInCookie:mantis.landPageUrlInCookie,site_id_in_cookie:mantis.sidInCookie,stag_in_cookie:mantis.stagInCookie,lp_calc:mantis.lp_calc,projectId:mantis.projectId};t.type="E",$.ajax({type:"POST",url:mantis.eAddr,crossDomain:!0,data:JSON.stringify(t),contentType:"text/plain",dataType:"json",success:function(e){return e?e.error?(mantis.e_id=null,console.error("fail to save t"),void initAutoChat()):(mantis.e_id=getTrackId(e.trackId),e.lp_calc&&("COOKIE"===e.lp_calc&&(mantis.siteId=e.site_id,mantis.stag=e.stag,mantis.isLandingPage=!1,mantis.landPageUrl=mantis.landPageUrlInCookie,setLPCookie(getLPId()),mantis.siteId&&Cookies.set("mantis_sid"+mantis.companyId,mantis.siteId,{expires:in30Minutes,domain:mantis.rootDomain}),mantis.stag&&Cookies.set("mantis_stag"+mantis.companyId,mantis.stag,{expires:in30Minutes,domain:mantis.rootDomain})),"URL_MATCH"===e.lp_calc?(mantis.lp_calc=e.lp_calc,mantis.isLandingPage=!0,mantis.landPageUrl=mantis.url,setLPCookie(),mantis.parsedRefer={ad:e.ad,siteId:e.site_id,plan:e.plan,unit:e.unit,subUnit:e.subUnit,creative:e.creative,source:"url"},mantis.stag=null,Cookies.set("mantisrf"+mantis.companyId,encodeURIComponent(JSON.stringify(mantis.parsedRefer)),{expires:in30Minutes,domain:mantis.rootDomain}),mantis.siteId=e.site_id,mantis.siteId&&Cookies.set("mantis_sid"+mantis.companyId,mantis.siteId,{expires:in30Minutes,domain:mantis.rootDomain})):"FIRST_VISIT"===e.lp_calc&&(mantis.isLandingPage=!0,mantis.landPageUrl=mantis.url,mantis.lp_calc=e.lp_calc,mantis.parsedRefer={},mantis.stag=null,mantis.siteId=null)),void initAutoChat()):(mantis.e_id=null,initAutoChat(),void console.error("fail to save t"))},error:function(){console.error("fail to save t"),initAutoChat()}})}function sendClick(e){mantis.e_id&&$.ajax({type:"POST",url:mantis.eAddr,crossDomain:!0,data:JSON.stringify(e),dataType:"json",contentType:"text/plain",success:function(){},error:function(){console.error("Post click information error-sendClick")}})}function sendAlive(e){var t={};t.type="L",t.e_id=mantis.e_id,t.ttl=Math.ceil(((new Date).getTime()-beginTime)/1e3),beginTime=(new Date).getTime(),t.company=mantis.companyId,t.buId=mantis.buId,t.uid=mantis.uid,t.why=e,t.mode=isMiniMode()?"yes":"no",$.ajax({type:"POST",url:mantis.eAddr,crossDomain:!0,data:JSON.stringify(t),contentType:"text/plain",dataType:"json",success:function(e){if(e){var t=e.hasForce;if(t){var i=e.force;if(i)return void doDirectChat(i)}var n=e.hasInvite;if(n){var a=e.invite;try{var s=JSON.parse(a);s&&doInvite(s)}catch(o){console.error("fail to parse the invite info",a)}}var r=e.latestMsg;r&&(isMiniMode()||updateTipMsg(r))}},error:function(){console.error("Post TTL information error-sendClick")}})}function removeTipStyle(e){if(!e)return"";try{return e.replace(/<\/?[^>]*>/g,"").replace(/&nbsp;/gi,"")}catch(t){}return""}function updateTipMsg(e){var t=e,i=e.indexOf("$$MANTIS_MSG_INVITE$$");i>0&&(t=e.substr(0,i));try{t=t.replace(/<\/?[^>]*>/g,"").replace(/&nbsp;/gi,"")}catch(n){}mantis.latestMsg!==t&&(mantis.latestMsg=t,isMobile.any?($("#MANTIS_MB_MSG_DIV").html(t),showMobileMsgDiv()):($("#MANTIS_PC_MSG_DIV").html(t),showPCMsgDiv()))}function switchChatHere(){if(isMiniMode()){if(mantis.isTimedOut)return;mantis.chat.hasChat||(mantis.req_mode="SWITCH",mantis.assignedAgent=null,callOpenMiniChat())}}function doDirectChat(e){try{var t=JSON.parse(e),i=t.agentId,n=t.used;!i||n&&"N"!==n||(mantis.req_mode="DIRECT_CHAT",mantis.assignedAgent=i,isMiniMode()?callOpenMiniChat("DIRECT_CHAT",mantis.request.serviceGroupId,!1):callOpenMaxChat("DIRECT_CHAT",mantis.request.serviceGroupId,!0))}catch(a){console.error("fail to parse the direct chat info",e)}}function doInvite(inviteInfo){if(!mantis.chat.hasChat){if(inviteInfo){var agentId=inviteInfo.agentId,used=inviteInfo.used;!agentId||used&&"N"!==used||(mantis.req_mode="INVITE",mantis.assignedAgent=agentId)}var setting=mantis.invite;if(setting.showInvite){var fun=setting.showInvite;return void eval(fun+"()")}var w=setting.width||600,h=setting.height||400,div=$("#MANTIS_INV_INNER_DIV");if(div.length&&div.length>0)showInviteDiv(setting);else{var kind=setting.kind||"project",file="";file="location"===kind?0===mantis.locationId?"":mantis.locationId:0===mantis.projectId?"":mantis.projectId,$("#MANTIS-INVITE-DIV").load(getStaticPath()+"/invite"+file+".html",function(){var e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;isMobile.any?$("#MANTIS_INV_INNER_DIV").css({margin:"0px auto",top:(t-h)/2+"px",left:(e-w)/2+"px",position:"fixed","z-index":999999}):(t=document.documentElement.clientHeight,e=document.documentElement.clientWidth,$("#MANTIS_INV_INNER_DIV").css({left:(e-w)/2+"px",top:(t-h)/2+"px","z-index":999999})),showInviteDiv(setting),$("#MANTIS_CHAT1")&&$("#MANTIS_CHAT1").bind("click",inviteToChat),$("#MANTIS_CHAT2")&&$("#MANTIS_CHAT2").bind("click",inviteToChat),$("#MANTIS_CHAT3")&&$("#MANTIS_CHAT3").bind("click",inviteToChat),$("#MANTIS_CLOSE")&&$("#MANTIS_CLOSE").bind("click",function(){hideInviteDiv()}),$("#MANTIS_CLOSE1")&&$("#MANTIS_CLOSE1").bind("click",function(){hideInviteDiv()})})}}}function initConfig(e){if(e){if(console.info("config found"),e.invite&&initInvite(e.invite),e.chat){var t=e.chat;initChatConfig(t)}if(e.welcome){var i=e.welcome;initWelcome(i)}e.tip&&(initTip(e.tip),initNormalChat())}postInit()}function initMinimize(){if(isMobile.any){if(isMobileIframe()&&0===$("#minimizeBox").length){var e='<div id="minimizeBox"><span id="minimizeIcon" onclick="mantis.requestChat()" class="iconfont icon-communicate"></span><div id="receiveMsg"><div id="minimizeNum" onclick="mantis.requestChat()"></div> <div id="animation"></div><div id="minimizeMsg"><span id="minimizeGB" onclick="onCloseMsgList()">╳</span><img id="minimizeHeader" src="http://talk2.bjmantis.net/chat/7002/10022/pc/img/default_counselor.jpg" width="25" height="25"/><div id="minimizeMsgList" onclick="mantis.requestChat()"></div></div></div></div>';$("body").append(e),mantis.probe&&(mantis.probe.mbIsShowMinimize||void 0===mantis.probe.mbIsShowMinimize)&&$("#minimizeBox").css("display","block"),$("#minimizeIcon").css({color:mantis.probe.mbBoxBgColor}),$("#minimizeNum").css({background:mantis.probe.mbBoxBgColor,color:mantis.probe.mbBoxFontColor})}}else if(isPCMini()&&0===$("#pcMsgTip").length){var t='<div id="pcMsgTip"><span id="pcMsgTipGB" onclick="onClosePCMsgList()">╳</span><div id="pcMsgTipMsgList" onclick="mantis.requestChat()"></div></div>';$("body").append(t)}}function showMBUnReadMsgTip(e){var t=$("#minimizeMsgList");if(t){addUnReadMsgNumber(),$("#minimizeMsgList").html("<p>"+removeTipStyle(e)+"</p>"),$("#receiveMsg,#minimizeMsg").css("display","block"),$("#minimizeIcon").css("display","none");var i=mantis.probe.mbAgentIcon;i&&$("#minimizeHeader").attr("src",i)}}function showPCUnReadMsgTip(e){var t=$("#pcMsgTipMsgList");t&&(addUnReadMsgNumber(),$("#pcMsgTipMsgList").html(removeTipStyle(e)),$("#pcMsgTip").css("display","block"))}function resetReadMsgTip(){clearUnreadMsgNumber();var e=$("#receiveMsg");e&&($("#receiveMsg").css("display","none"),$("#minimizeIcon").css("display","block"))}function addUnReadMsgNumber(){mantis.chat.unReadMsgNumber=mantis.chat.unReadMsgNumber+1;var e=$("#minimizeNum");e&&e.html(mantis.chat.unReadMsgNumber)}function clearUnreadMsgNumber(){mantis.chat.unReadMsgNumber=0;var e=$("#minimizeNum");e&&e.html("")}function onCloseMsgList(){var e=$("#minimizeMsg");e&&e.css("display","none")}function onClosePCMsgList(){var e=$("#pcMsgTip");e&&e.css("display","none")}function loadConfig(){$.support.cors=!0,$.ajax({dataType:"json",url:getConfigPath()+"/config.json",crossDomain:!0,success:function(e){initConfig(e)},error:function(){console.error("fail to load config"),initConfig(defaultConfig)}})}function calcPcChatMode(e){return mantis.probe&&mantis.probe.pcIsMini?void(mantis.chatMode="MINI"):mantis.probe&&!mantis.probe.pcIsMini?void(mantis.chatMode="FULL_TIP"):"MINI"===mantis.pc_page_chat_mode?void(mantis.chatMode="MINI"):"MINI"===e?void(mantis.chatMode="MINI"):void(e||(mantis.chatMode="FULL_TIP"))}function initChatConfig(e){if(MAX_REMINDER=e.maxRemCount||MAX_REMINDER,REMINDER_INTERVAL=e.remInterval||REMINDER_INTERVAL,mantis.multipleSites=e.multipleSites||mantis.multipleSites,mantis.ipCheck=e.ipCheck||mantis.ipCheck,mantis.hideChatIcon=e.hideChatIcon||"false",isMobile.any||calcPcChatMode(e.mode),isMobile.any?(mantis.probeUsed&&(mantis.mb_use_iframe=!0),mantis.mb_chat_template=mantis.probeUsed?e.mb_chat_template_iframe:e.mb_chat_template):isPCMini()?(mantis.pc_chat_template=e.mini_chat_template||"mini_chat",mantis.miniChatLoc=mantis.probe&&mantis.probe.position?mantis.probe.position:e.miniChatLoc||"right",mantis.mini_chat_width=e.mini_chat_width||400,mantis.mini_chat_height=e.mini_chat_height||490,mantis.mini_btn_hidden=e.mini_btn_hidden,mantis.mini_resv_width=e.mini_resv_width||400,mantis.mini_resv_height=e.mini_resv_height||490):mantis.pc_chat_template=e.w_chat_template,mantis.probeUsed&&mantis.probe&&(mantis.chat.autoChatDelay=isMobile.any?mantis.probe.mbAutoChatDelay:isPCMini()?mantis.probe.pcMiniAutoChatDelay:-1),isMiniMode()){var t=getIframeObj();mantis.messager.addTarget(t.contentWindow,"chatFrame"),mantis.messager.addTarget(t.contentWindow,"m_chatFrame"),mantis.messager.listen(function(e){var t=JSON.parse(e);if(t&&t.type&&"msg"===t.type&&(isMobile.any?showMBUnReadMsgTip(t.msg):showPCUnReadMsgTip(t.msg)),t&&t.type&&"chat"===t.type&&setHasChat(t.hasChat,t.isTimedOut,t.chatId),t&&t.type&&"move"===t.type)switch(t.msg){case"MANTIS_DRAG_START":handleDragStart(t.mouseX,t.mouseY);break;case"MANTIS_DRAG_MOUSEMOVE":handleFrameMousemove(t.offsetX,t.offsetY);break;case"MANTIS_DRAG_END":handleDragEnd()}var i=t.media;t&&t.type&&"MANTIS_CHAT_WINDOW_FLAG"===t.type&&("MB"===i?locateMBChatWindow(t.flag):locateChatWindow(t.flag)),t&&t.type&&"MANTIS_RESV_WINDOW_FLAG"===t.type&&("MB"===i?locateMBResvWindow(t):locateResvWindow(t)),t&&t.type&&"MANTIS_HIDE_INVITE"===t.type&&hideInviteDiv()})}}function isPCMini(){return"MINI"===mantis.chatMode?!0:!1}function isMobileIframe(){return mantis.mb_use_iframe?!0:!1}function initTip(e){var t;if(t=isMobile.any?e.mobile:e.pc){var i=t.enable;i?(mantis.showTip=!0,mantis.tip={close_img:t.close_img,company_img:t.company_img,company_name:t.company_name}):mantis.showTip=!1}}function initInvite(e){var t;if(t=isMobile.any?e.mobile:e.pc){e.showInvite&&(t.showInvite=e.showInvite),mantis.invite=t;var i=t.enable;i&&doInvite()}}function showInviteDiv(e){var t=e.delay||3,i=e.repeat;setTimeout(function(){mantis.chat.isChatShow||inviteDiv.show()},1e3*t),i>0&&setInterval(function(){mantis.chat.isChatShow||inviteDiv.show()},1e3*i)}function setupActiveTTl(){mantis.ttlInterval&&clearInterval(mantis.ttlInterval),mantis.ttlInterval=setInterval(function(){sendAlive("focus_ttl")},15e3)}function setupInactiveTTL(){mantis.ttlInterval&&clearInterval(mantis.ttlInterval),mantis.ttlInterval=setInterval(function(){sendAlive("blur_ttl")},15e3)}function getUrlVars(e){var t=e+"",i={},n=t.lastIndexOf("?");if(-1===n)return i;{var a=t.substr(n,t.length);a.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,t,n){i[t]=n})}return i}function mySubStr(e,t){if(!e)return"";var i=e.length;return i>t&&(i=t),e.substr(0,i)}function parseReferer(e){var t={};if(!e)return t;for(var i=getUrlVars(decodeURI(e)),n=0;n<ADVARRAY.length;n++){var a=ADVARRAY[n];if(e.indexOf(a.clue)>0){t.ad=a.ad,t.type=a.type,t.source="referer",a.searchwd&&a.searchwd.forEach(function(e){var n=i[e];n&&n.replace(/(^s*)|(s*$)/g,"").length>0&&(t.searchwd=mySubStr(n,100))}),a.suggest&&a.suggest.forEach(function(e){var n=i[e];n&&n.replace(/(^s*)|(s*$)/g,"").length>0&&(t.suggest=mySubStr(n,100))}),a.bf_searchwd&&a.bf_searchwd.forEach(function(e){var n=i[e];n&&n.replace(/(^s*)|(s*$)/g,"").length>0&&(t.bf_searchwd=mySubStr(n,100))}),a.open_searchwd&&a.open_searchwd.forEach(function(e){var n=i[e];n&&n.replace(/(^s*)|(s*$)/g,"").length>0&&(t.open_searchwd=mySubStr(n,100))});break}}try{t&&t.searchwd&&(t.searchwd=tryToDecodeUrl(t.searchwd)),t&&t.open_searchwd&&(t.open_searchwd=tryToDecodeUrl(t.open_searchwd))}catch(s){}return t}function updateTitle(e){$(".notify").html(e)}function hidePCMsgDiv(){$("#MANTIS-PC-DIV").hide("slow")}function showPCMsgDiv(){pcMsgHideTmr&&clearTimeout(pcMsgHideTmr),$("#MANTIS-PC-DIV").show("fast"),pcMsgHideTmr=setTimeout(function(){"focus"===mantis.status&&hidePCMsgDiv()},3e4)}function hideMobileMsgDiv(){$("#MANTIS-MOBILE-DIV").hide("slow")}function showMobileMsgDiv(){mbMsgHideTmr&&clearTimeout(mbMsgHideTmr),$("#MANTIS-MOBILE-DIV").show("fast"),mbMsgHideTmr=setTimeout(function(){"focus"===mantis.status&&hideMobileMsgDiv()},3e4)}function inviteToChat(){var e,t={},i=$(this).attr("mdesc");if(i){var n=i.split("/");n.length>2&&(e=n[2]?n[2]:""),n.length>1&&(isMiniMode()?mantis.chat.hasChat&&e===mantis.request.serviceGroupId?(callOpenMiniChat(n[0],e,!1),hideInviteDiv()):(mantis.request.serviceGroupId=e,callOpenMiniChat(n[0],e,!1),hideInviteDiv()):openMaxChat(n[0],e,!1)),t.ele_name=n[0],t.e_id=mantis.e_id,t.type="C",sendClick(t)}else console.warn("please specify the mdesc element!")}function visitorOpenChat(){mantis.req_mode="VISTOR";var e,t={},i=$(this).attr("mdesc");if(i){var n=i.split("/");n.length>2&&(e=n[2]?n[2]:""),n.length>1&&(isMiniMode()?mantis.chat.hasChat&&e===mantis.request.serviceGroupId?(callOpenMiniChat(n[0],e,!1),hideInviteDiv()):(mantis.request.serviceGroupId=e,callOpenMiniChat(n[0],e,!1),hideInviteDiv()):openMaxChat(n[0],e,!1)),t.ele_name=n[0],t.e_id=mantis.e_id,t.type="C",sendClick(t)}else console.warn("please specify the mdesc element!");return!1}function isMiniMode(){try{return isMobile.any?isMobileIframe()?!0:!1:isPCMini()?!0:!1}catch(e){console.error("fail to parse media")}return!1}function initNormalChat(){if(!isMiniMode()&&mantis.showTip)if(isMobile.any){var e=$("#MANTIS-MOBILE-DIV");e.length&&0!==e.length||$("body").append('<div id="MANTIS-MOBILE-DIV"></div>');var t="/mobile_tip";mantis.multipleSites&&(mantis.brand?t=t+mantis.locationId+"_"+mantis.brand:t+=mantis.locationId),t+=".html",$("#MANTIS-MOBILE-DIV").load(getStaticPath()+t,function(){var e=$("#MANTIS-BUBBLE-INSIDE");e&&e.bind("click",openMaxChat);var t=$("#MANTIS-BUBBLE-CLOSE");t&&t.bind("click",hideMobileMsgDiv),mantis.tip.close_img&&$("#MANTIS-BUBBLE-CLOSE").attr("src",mantis.tip.close_img),mantis.tip.company_img&&$("#MANTIS-BUBBLE-AVATAR").attr("src",mantis.tip.company_img),mantis.tip.company_name&&$("#MANTIS-BUBBLE-NAME").html(mantis.tip.company_name)}),$("#MANTIS-MOBILE-DIV").hide(),mantis.hideMobileMsgDiv=hideMobileMsgDiv}else{var i="/pc_tip";mantis.multipleSites&&(mantis.brand?i=i+mantis.locationId+"_"+mantis.brand:i+=mantis.locationId),i+=".html";var n=$("#MANTIS-PC-DIV");n.length&&0!=n.length||$("body").append('<div id="MANTIS-PC-DIV"></div>'),$("#MANTIS-PC-DIV").load(getStaticPath()+i,function(){var e=$("#MANTIS-BUBBLE-INSIDE");e&&e.bind("click",openMaxChat);var t=$("#MANTIS-BUBBLE-CLOSE");t&&t.bind("click",hidePCMsgDiv()),mantis.tip.close_img&&$("#MANTIS-BUBBLE-CLOSE").attr("src",mantis.tip.close_img),mantis.tip.company_img&&$("#MANTIS-BUBBLE-AVATAR").attr("src",mantis.tip.company_img),mantis.tip.company_name&&$("#MANTIS-BUBBLE-NAME").html(mantis.tip.company_name)}),$("#MANTIS-PC-DIV").hide(),mantis.hidePCMsgDiv=hidePCMsgDiv}}function initWelcome(e){mantis.welcome=e||{}}function initMiniChat(){if(!iframeObj||0===iframeObj.length)if(isMobile.any){{document.documentElement.clientWidth||document.body.clientWidth||window.innerWidth}$("body").append("<div id='mantisChatBox'><iframe id=\"MANTIS-CHAT-DIV\" frameborder=\"no\" style='z-index: 99999; position: absolute; width: 100%; height: 85%;left:0;right:0;bottom:0;'></iframe></div>"),mantis.webkit.indexOf("baiduboxapp")>0&&mantis.webkit.indexOf("Android")>0&&$("#mantisChatBox").css({position:"absolute"})}else $("body").append('<iframe id="MANTIS-CHAT-DIV" frameborder="no" style=\'z-index: 99999; position: fixed; width: 0px; height: 0px;\'></iframe>');iframeObj=$("#MANTIS-CHAT-DIV")}function loadInviteDiv(){inviteDiv&&0!==inviteDiv.length||($("body").append('<div id="MANTIS-INVITE-DIV"></div>'),$("#MANTIS-INVITE-DIV").hide()),inviteDiv=$("#MANTIS-INVITE-DIV")}function getCustomizeJSPath(){return mantis.chatAddr+mantis.companyId}function appendCustomerHeader(){if(isMobile.any){for(var e,t=$("meta"),i=0;i<t.length;++i){var n=$(t[i]);/viewport/i.test(n.attr("name"))&&(mantis.isFirstSetMeta&&(mantis.oldViewport=n.attr("content"),mantis.isFirstSetMeta=!1),n.attr("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"),e=!0)}if(!e){var a=document.createElement("meta");a.name="viewport",a.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"),document.getElementsByTagName("head")[0].appendChild(a)}}}function removeCustomerHeader(){var e=$("meta");if(mantis.oldViewport)for(var t=0;t<e.length;++t){var i=$(e[t]);/viewport/i.test(i.attr("name"))&&i.attr("content",mantis.oldViewport)}else for(var t=0;t<e.length;++t){var i=$(e[t]);/viewport/i.test(i.attr("name"))&&i.attr("content","width=device-width, initial-scale=0.33, maximum-scale=0.33, user-scalable=0")}}function appendCustomizeClass(){if(isMobile.any){var e=document.getElementsByTagName("body")[0],t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=mantis.chatAddr+"css/mbody.css",e.appendChild(t)}else{var e=document.getElementsByTagName("body")[0],t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=mantis.chatAddr+"css/PCMiniStyle.css",e.appendChild(t)}}function appendCustomizeJS(){var e=document.getElementsByTagName("body")[0],t=document.createElement("script");t.type="text/javascript",t.src=getCustomizeJSPath()+"/js/lp.js",e.appendChild(t)}function saveMantisId(){var e=Cookies.get("mantisId");e&&"undefined"!==e&&e.replace(/(^s*)|(s*$)/g,"").length>0?mantis.mantisId=e:(mantis.mantisId=createGuid(),Cookies.set("mantisId",mantis.mantisId,{expires:1e3,domain:mantis.rootDomain}))}function openMiniChat(e,t,i){appendCustomerHeader();var n=i||!1;mantis.req_mode=mantis.req_mode||"VISTOR";var a=e?encodeURIComponent(e):"",s="";mantis.title&&(s=encodeURIComponent(mantis.title));var o=1,r=mantis.uid;t||mantis.siteId||mantis.defaultSg||(o=2,console.warn("No siteId or serviceGroupId was defined!")),r||(o=2,console.warn("uid was not generated!"));var m=null;m=mantis.parsedRefer?encodeURIComponent(JSON.stringify(mantis.parsedRefer)):Cookies.get("mantisrf"+mantis.companyId);var d=mantis.uiPath?encodeURIComponent(mantis.uiPath):"",c=encodeURIComponent(mantis.ctag),l=location.hash?encodeURIComponent(location.hash):"",u="muid="+mantis.uid+"&msid="+mantis.siteId+"&mstag="+mantis.stag+"&mcid="+mantis.companyId+"&mbuid="+mantis.buId+"&mgid="+getValueStr(t)+"&mpath="+d+"&magent="+getValueStr(mantis.assignedAgent)+"&mprj="+mantis.projectId+"&mdgid="+mantis.defaultSg+"&muuid="+mantis.mantisId+"&mmode="+mantis.req_mode+"&mbrd="+mantis.brand+"&mcc="+mantis.ipCheck+"&mflag="+o+"&mtid="+mantis.e_id+"&mlpid="+getLPId()+"&mwd="+getValueStr(m)+"&mele="+a+"&mtitle="+s+"&mctag="+c+"&mloc="+mantis.locationId+"&mh="+l+"&met="+getLandingPage(),p="",h=isMobile.any?"/mobile":"/pc";if(isMobile.any?p=mantis.chatAddr+mantis.mb_chat_template+"?"+u:mantis.pc_chat_template?p=mantis.chatAddr+mantis.pc_chat_template+"?"+u:(p=mantis.chatAddr+mantis.companyId+"/"+mantis.buId+h+"/mini_chat",mantis.multipleSites&&(mantis.brand?p=p+mantis.locationId+"_"+mantis.brand:p+=mantis.locationId),p=p+".html?"+u),n)openMaxChat(e,t,i);else{var f=getIframeObj().src;if(f){var g={type:"request",msg:"MANTIS_REQUEST"};mantis.messager.send(JSON.stringify(g))}else getIframeObj().src=p}return!1}function hideChat(){var e={type:"chat_window",msg:"HIDE"};mantis.messager.send(JSON.stringify(e))}function getValueStr(e){return e?"undefined"===e?"":e:""}function getLandingPage(){return mantis.landPageUrl?mantis.landPageUrl:window.location.href?window.location.href:""}function openMaxChat(e,t,i){var n=i||!1;isMobile.any&&(n=!0),mantis.req_mode=mantis.req_mode||"VISTOR";var a=e?encodeURIComponent(e):"",s="";mantis.title&&(s=encodeURIComponent(mantis.title));var o=1,r=mantis.uid;t||mantis.siteId||mantis.defaultSg||(o=2,console.warn("No siteId or serviceGroupId was defined!")),r||(o=2,console.warn("uid was not generated!"));var m=null;m=mantis.parsedRefer?encodeURIComponent(JSON.stringify(mantis.parsedRefer)):Cookies.get("mantisrf"+mantis.companyId);var d=mantis.uiPath?encodeURIComponent(mantis.uiPath):"",c=location.hash?encodeURIComponent(location.hash):"",l=encodeURIComponent(mantis.ctag),u="muid="+mantis.uid+"&msid="+mantis.siteId+"&mstag="+mantis.stag+"&mcid="+mantis.companyId+"&mbuid="+mantis.buId+"&mgid="+t+"&mpath="+d+"&magent="+mantis.assignedAgent+"&mprj="+mantis.projectId+"&mdgid="+mantis.defaultSg+"&muuid="+mantis.mantisId+"&mmode="+mantis.req_mode+"&mbrd="+mantis.brand+"&mcc="+mantis.ipCheck+"&mflag="+o+"&mtid="+mantis.e_id+"&mlpid="+getLPId()+"&mwd="+m+"&mele="+a+"&mtitle="+s+"&mctag="+l+"&mh="+c+"&met="+getLandingPage(),p=isMobile.any?"/mobile":"/pc",h="";if(isMobile.any?mantis.mb_chat_template?h=mantis.chatAddr+mantis.mb_chat_template+"?"+u:(h=mantis.chatAddr+mantis.companyId+"/"+mantis.buId+p+"/chat",mantis.multipleSites&&(mantis.brand?h=h+mantis.locationId+"_"+mantis.brand:h+=mantis.locationId),h=h+".html?"+u):mantis.pc_chat_template?h=mantis.chatAddr+mantis.pc_chat_template+"?"+u:(h=mantis.chatAddr+mantis.companyId+"/"+mantis.buId+p+"/chat",mantis.multipleSites&&(mantis.brand?h=h+mantis.locationId+"_"+mantis.brand:h+=mantis.locationId),h=h+".html?"+u),n)window.location.href=h;else{if(!isMobile.any&&mantis.chatWindow&&!mantis.chatWindow.closed)return void mantis.chatWindow.focus();mantis.chatWindow=window.open(h)}return!1}function callOpenMiniChat(e,t,i){requestTmr&&(clearInterval(requestTmr),requestTmr=null),mantis.companyId?openMiniChat(e,t,i):requestTmr=setInterval(function(){callOpenMiniChat(e,t,i)},50)}function callOpenMaxChat(e,t,i){requestTmr&&(clearInterval(requestTmr),requestTmr=null),mantis.companyId?openMaxChat(e,t,i):requestTmr=setInterval(function(){callOpenMaxChat(e,t,i)},50)}function createGuid(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"===e?t:3&t|8;return i.toString(16)})}function getStaticPath(){var e=isMobile.any?"/mobile":"/pc";return mantis.chatAddr+mantis.companyId+"/"+mantis.buId+e}function getConfigPath(){return mantis.chatAddr+mantis.companyId+"/"+mantis.buId}function getLandingPageByCookie(){var e=Cookies.get("mantis_lp"+mantis.companyId);if(e&&"undefined"!==e)try{e=decodeURI(e)}catch(t){e=null}else e=null;return e}function setLPCookie(e){mantis.landingPageId=e?e:"lp:"+createGuid()+"@"+mantis.companyId,Cookies.set("mantis_lp"+mantis.companyId,encodeURI(mantis.landPageUrl),{expires:in30Minutes,domain:mantis.rootDomain}),Cookies.set("mantis_lp_id"+mantis.companyId,encodeURI(mantis.landingPageId),{expires:in30Minutes,domain:mantis.rootDomain})}function getLPId(){var e=Cookies.get("mantis_lp_id"+mantis.companyId);if(e&&"undefined"!==e)try{
e=decodeURI(e)}catch(t){e=null}else e=null;return e}function shortMsg(e,t){if(!e)return"";var i=e.length;return 0===i?"":i>t?e.substr(0,t):e.substr(0,i)}function setHasChat(e,t,i){e?(mantis.chat.hasChat=!0,mantis.chat.chatId=i):mantis.chat.hasChat=!1,mantis.isTimedOut=t}function addManitsEventListener(e,t,i){e&&(e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i.bind(e)))}function removeMantisEventListener(e,t,i){e&&(e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent("on"+t,i.bind(e)))}function handleDragStart(e,t){pageMouseX=frameLeft+e,pageMouseY=frameTop+t,addManitsEventListener(document,"mouseup",handleDragEnd),addManitsEventListener(document,"mousemove",handlePageMousemove)}function handleDragEnd(){removeMantisEventListener(document,"mouseup",handleDragEnd),removeMantisEventListener(document,"mousemove",handlePageMousemove)}function handleFrameMousemove(e,t){frameTop+=t,frameLeft+=e,iframeObj[0].style.top=frameTop+"px",iframeObj[0].style.left=frameLeft+"px",pageMouseX+=e,pageMouseY+=t}function handlePageMousemove(e){frameTop+=e.clientX-pageMouseX,frameLeft+=e.clientY-pageMouseY,iframeObj[0].style.top=frameTop+"px",iframeObj[0].style.left=frameLeft+"px",pageMouseX=e.clientX,pageMouseY=e.clientY}function locateMBChatWindow(e){"SHOW"===e&&($("#MANTIS-CHAT-DIV").css({height:mantis.chat.mbIframeHeight+"%"}),$("#mantisChatBox").slideDown("fast"),mantis.chat.isChatShow=!0,saveScollLoc(),$("body").addClass("bodyStyle"),$("html").addClass("htmlStyle"),addPageTilte(),resetReadMsgTip()),"HIDE"===e&&($("#mantisChatBox").slideUp(),mantis.chat.isChatShow=!1,$("body").removeClass("bodyStyle"),$("html").removeClass("htmlStyle"),removeCustomerHeader(),resetScrollLoc())}function saveScollLoc(){mantis.curx=$(document).scrollLeft(),mantis.cury=$(document).scrollTop()}function resetScrollLoc(){(mantis.curx>0||mantis.cury>0)&&window.scroll(mantis.curx,mantis.cury)}function locateChatWindow(e){var t=mantis.mini_chat_width||638,i=mantis.mini_chat_height||591,n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;"SHOW"===e&&("center"===mantis.miniChatLoc&&($("#MANTIS-CHAT-DIV").css({left:(n-t)/2+"px",top:(a-i)/2+"px",width:t+"px",height:i+"px"}),frameLeft=(n-t)/2,frameTop=(a-i)/2),"right"===mantis.miniChatLoc&&($("#MANTIS-CHAT-DIV").css({top:a-i-2+"px",right:"0px",width:t+"px",height:i+"px"}),frameLeft=n-t-2,frameTop=a-i-2),mantis.chat.isChatShow=!0,onClosePCMsgList()),"HIDE"===e&&(mantis.mini_btn_hidden?$("#MANTIS-CHAT-DIV").css({width:"0px",height:"0px"}):($("#MANTIS-CHAT-DIV").css({top:"auto",left:"auto",right:"20px",bottom:"0px",width:"400px",height:"50px"}),frameLeft=n-400-2,frameTop=a-50-2),mantis.chat.isChatShow=!1)}function locateMBResvWindow(obj){var flag=obj.flag,func=obj.func,clientWidth=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,clientHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;if("SHOW"===flag){if(saveScollLoc(),func)try{eval(func+"()")}catch(e){console.error("fail to call show")}else $("#MANTIS-CHAT-DIV").css({height:mantis.chat.mbIframeHeight+"%"}),$("#mantisChatBox").slideDown("fast"),$("body").addClass("bodyStyle"),$("html").addClass("htmlStyle");addPageTilte(),resetReadMsgTip()}if("HIDE"===flag){if(func)try{eval(func+"()")}catch(e){console.error("fail to call hide")}else $("#mantisChatBox").slideUp(),$("body").removeClass("bodyStyle"),$("html").removeClass("htmlStyle");resetScrollLoc()}}function setupBodyStyle(){$("#MANTIS-CHAT-DIV").slideDown("fast"),$("body").css({overflow:"hidden",height:"100%"})}function cancelBodyStyle(){$("#MANTIS-CHAT-DIV").slideUp(),$("body").css({overflow:"auto",height:"auto",position:"static !important;",left:0,top:0,bottom:0,right:0})}function locateResvWindow(obj){var flag=obj.flag,func=obj.func,w=400,h=490;mantis.mini_resv_width&&(w=mantis.mini_resv_width),mantis.mini_resv_height&&(h=mantis.mini_resv_height);var clientWidth=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,clientHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;if("SHOW"===flag)if(func)try{eval(func+"()")}catch(e){console.error("fail to call show")}else"center"===mantis.miniChatLoc&&($("#MANTIS-CHAT-DIV").css({left:(clientWidth-w)/2+"px",top:(clientHeight-h)/2+"px",width:w+"px",height:h+"px"}),frameLeft=(clientWidth-w)/2,frameTop=(clientHeight-h)/2),"right"===mantis.miniChatLoc&&($("#MANTIS-CHAT-DIV").css({left:clientWidth-w-2+"px",top:clientHeight-h-2+"px",width:w+"px",height:h+"px"}),frameLeft=clientWidth-w-2,frameTop=clientHeight-h-2);else if("HIDE"===flag&&func)try{eval(func+"()")}catch(e){console.error("fail to call hide")}}function hideInviteDiv(){$("#MANTIS-INVITE-DIV").hide()}function getIframeObj(){var e=document.getElementById("MANTIS-CHAT-DIV");return e||(e=document.frames["MANTIS-CHAT-DIV"]),e}window.Messenger=function(){function e(e,t,i){var n="";if(arguments.length<2?n="target error - target and name are both required":"object"!=typeof e?n="target error - target itself must be window object":"string"!=typeof t&&(n="target error - target name must be string type"),n)throw new Error(n);this.target=e,this.name=t,this.prefix=i}function t(e,t){this.targets={},this.name=e,this.listenFunc=[],this.prefix=t||i,this.initListen()}var i="[mantis]",n="postMessage"in window;return e.prototype.send=n?function(e){this.target.postMessage(this.prefix+"|"+this.name+"__Messenger__"+e,"*")}:function(e){var t=window.navigator[this.prefix+this.name];if("function"!=typeof t)throw new Error("target callback function is not defined");t(this.prefix+"|"+this.name+"__Messenger__"+e,window)},t.prototype.addTarget=function(t,i){var n=new e(t,i,this.prefix);this.targets[i]=n},t.prototype.initListen=function(){var e=this,t=function(t){if("object"==typeof t&&(t=t.data),t)for(var i=t.split("__Messenger__"),t=i[1],n=i[0].split("|"),a=n[0],s=n[1],o=0;o<e.listenFunc.length;o++)a+s===e.prefix+e.name&&e.listenFunc[o](t)};n?"addEventListener"in document?window.addEventListener("message",t,!1):"attachEvent"in document&&window.attachEvent("onmessage",t):window.navigator[this.prefix+this.name]=t},t.prototype.listen=function(e){for(var t=0,i=this.listenFunc.length,n=!1;i>t;t++)if(this.listenFunc[t]==e){n=!0;break}n||this.listenFunc.push(e)},t.prototype.clear=function(){this.listenFunc=[]},t.prototype.send=function(e){var t,i=this.targets;for(t in i)i.hasOwnProperty(t)&&i[t].send(e)},t}(),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){if(e.support.cors||!e.ajaxTransport||!window.XDomainRequest)return e;var t=/^(https?:)?\/\//i,i=/^get|post$/i,n=new RegExp("^(//|"+location.protocol+")","i");return e.ajaxTransport("* text html xml json",function(a,s){if(a.crossDomain&&a.async&&i.test(a.type)&&t.test(a.url)&&n.test(a.url)){var o=null;return{send:function(t,i){var n="",r=(s.dataType||"").toLowerCase();o=new XDomainRequest,/^\d+$/.test(s.timeout)&&(o.timeout=s.timeout),o.ontimeout=function(){i(500,"timeout")},o.onload=function(){var t="Content-Length: "+o.responseText.length+"\r\nContent-Type: "+o.contentType,n={code:200,message:"success"},a={text:o.responseText};try{if("html"===r||/text\/html/i.test(o.contentType))a.html=o.responseText;else if("json"===r||"text"!==r&&/\/json/i.test(o.contentType))try{a.json=e.parseJSON(o.responseText)}catch(s){n.code=500,n.message="parseerror"}else if("xml"===r||"text"!==r&&/\/xml/i.test(o.contentType)){var m=new ActiveXObject("Microsoft.XMLDOM");m.async=!1;try{m.loadXML(o.responseText)}catch(s){m=void 0}if(!m||!m.documentElement||m.getElementsByTagName("parsererror").length)throw n.code=500,n.message="parseerror","Invalid XML: "+o.responseText;a.xml=m}}catch(d){throw d}finally{i(n.code,n.message,a,t)}},o.onprogress=function(){},o.onerror=function(){i(500,"error",{text:o.responseText})},s.data&&(n="string"===e.type(s.data)?s.data:e.param(s.data)),o.open(a.type,a.url),o.send(n)},abort:function(){o&&o.abort()}}}}),e}),!function(e){if("function"==typeof define&&define.amd)define(e);else if("object"==typeof exports)module.exports=e();else{var t=window.Cookies,i=window.Cookies=e();i.noConflict=function(){return window.Cookies=t,i}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}function t(i){function n(t,a,s){var o;if("undefined"!=typeof document){if(arguments.length>1){if(s=e({path:"/"},n.defaults,s),"number"==typeof s.expires){var r=new Date;r.setMilliseconds(r.getMilliseconds()+864e5*s.expires),s.expires=r}try{o=JSON.stringify(a),/^[\{\[]/.test(o)&&(a=o)}catch(m){}return a=i.write?i.write(a,t):encodeURIComponent(String(a)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)),t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),t=t.replace(/[\(\)]/g,escape),document.cookie=[t,"=",a,s.expires&&"; expires="+s.expires.toUTCString(),s.path&&"; path="+s.path,s.domain&&"; domain="+s.domain,s.secure?"; secure":""].join("")}t||(o={});for(var d=document.cookie?document.cookie.split("; "):[],c=/(%[0-9A-Z]{2})+/g,l=0;l<d.length;l++){var u=d[l].split("="),p=u.slice(1).join("=");'"'===p.charAt(0)&&(p=p.slice(1,-1));try{var h=u[0].replace(c,decodeURIComponent);if(p=i.read?i.read(p,h):i(p,h)||p.replace(c,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(m){}if(t===h){o=p;break}t||(o[h]=p)}catch(m){}}return o}}return n.set=n,n.get=function(e){return n(e)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(t,i){n(t,"",e(i,{expires:-1}))},n.withConverter=t,n}return t(function(){})}),!function(e){var t=/iPhone/i,i=/iPod/i,n=/iPad/i,a=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,s=/Android/i,o=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,r=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,m=/IEMobile/i,d=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,c=/BlackBerry/i,l=/BB10/i,u=/Opera Mini/i,p=/(CriOS|Chrome)(?=.*\bMobile\b)/i,h=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,f=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),g=function(e,t){return e.test(t)},v=function(e){var v=e||navigator.userAgent,b=v.split("[FBAN");return"undefined"!=typeof b[1]&&(v=b[0]),b=v.split("Twitter"),"undefined"!=typeof b[1]&&(v=b[0]),this.apple={phone:g(t,v),ipod:g(i,v),tablet:!g(t,v)&&g(n,v),device:g(t,v)||g(i,v)||g(n,v)},this.amazon={phone:g(o,v),tablet:!g(o,v)&&g(r,v),device:g(o,v)||g(r,v)},this.android={phone:g(o,v)||g(a,v),tablet:!g(o,v)&&!g(a,v)&&(g(r,v)||g(s,v)),device:g(o,v)||g(r,v)||g(a,v)||g(s,v)},this.windows={phone:g(m,v),tablet:g(d,v),device:g(m,v)||g(d,v)},this.other={blackberry:g(c,v),blackberry10:g(l,v),opera:g(u,v),firefox:g(h,v),chrome:g(p,v),device:g(c,v)||g(l,v)||g(u,v)||g(h,v)||g(p,v)},this.seven_inch=g(f,v),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window?this:void 0},b=function(){var e=new v;return e.Class=v,e};"undefined"!=typeof module&&module.exports&&"undefined"==typeof window?module.exports=v:"undefined"!=typeof module&&module.exports&&"undefined"!=typeof window?module.exports=b():"function"==typeof define&&define.amd?define("isMobile",[],e.isMobile=b()):e.isMobile=b()}(this),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,n,a,s,o,r=gap,m=t[e];switch(m&&"object"==typeof m&&"function"==typeof m.toJSON&&(m=m.toJSON(e)),"function"==typeof rep&&(m=rep.call(t,e,m)),typeof m){case"string":return quote(m);case"number":return isFinite(m)?String(m):"null";case"boolean":case"null":return String(m);case"object":if(!m)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(m)){for(s=m.length,i=0;s>i;i+=1)o[i]=str(i,m)||"null";return a=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+r+"]":"["+o.join(",")+"]",gap=r,a}if(rep&&"object"==typeof rep)for(s=rep.length,i=0;s>i;i+=1)"string"==typeof rep[i]&&(n=rep[i],a=str(n,m),a&&o.push(quote(n)+(gap?": ":":")+a));else for(n in m)Object.prototype.hasOwnProperty.call(m,n)&&(a=str(n,m),a&&o.push(quote(n)+(gap?": ":":")+a));return a=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+r+"}":"{"+o.join(",")+"}",gap=r,a}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(e,t){var i,n,a=e[t];if(a&&"object"==typeof a)for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n=walk(a,i),void 0!==n?a[i]=n:delete a[i]);return reviver.call(e,t,a)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();var mantis={};mantis.requestChat=globalRequestChat,mantis.chat={},mantis.parsedRefer={},mantis.tip={},mantis.chat.hasChat=!1,mantis.chat.isChatShow=!1,mantis.chatWindow=null,mantis.landingPageId=null,mantis.isTimedOut=!1,mantis.isChatWindowMoved=!1,mantis.messager=new Messenger("parent","mantisFrame");var iframeObj=null,inviteDiv=null,pageMouseX,pageMouseY,frameTop=0,frameLeft=0;mantis.multipleSites=!1,mantis.ipCheck=0,mantis.request={},mantis.request.serviceGroupId=null,mantis.assignedAgent=null,mantis.req_mode="",mantis.showTip=!0,mantis.rootDomain=extractDomain(),mantis.isLandingPage=!1,mantis.probeUsed=!1,mantis.isFirstSetMeta=!0,mantis.webkit=navigator.userAgent;var beginTime=(new Date).getTime(),pcMsgHideTmr,mbMsgHideTmr,requestTmr,defaultConfig={chat:{remInterval:3,maxRemCount:2,multipleSites:!1,mbRemoveTag:!0,miniChatLoc:"center",mode:"MINI",showAgentName:!1,agent_img:"http://talk2.bjmantis.net/chat/7057/10744/pc/img/default_counselor.jpg",agent_msg_icon:"http://talk2.bjmantis.net/chat/7057/10744/pc/img/default_counselor.jpg",mini_chat_template:"t1/pc/mini_fm_tab0.html",mini_chat_width:638,mini_chat_height:591,mini_resv_width:358,mini_resv_height:328,mb_chat_template:"t1/mobile/chat.html",mb_chat_template_iframe:"t1/mobile/chat_iframe.html",mbChatHeaderTitleImg:"http://talk2.bjmantis.net/chat/7001/10015/pc/img/default_counselor.jpg",mbChatHeaderTitleTxt:"咨询对话"}},ADVARRAY=[{clue:"baidu.com",ad:"baidu",type:"sem",searchwd:["wd","word"],suggest:["sug"],bf_searchwd:["oq"],open_searchwd:["bs"]},{clue:"sogou.com",ad:"sogou",type:"sem",searchwd:["query","keyword"]},{clue:"soso.com",ad:"sogou",type:"sem",searchwd:["keyword"]},{clue:"so.com",ad:"360",type:"sem",searchwd:["q"]},{clue:"sm.cn",ad:"shenma",type:"sem",searchwd:["q"]},{clue:"bing.com",ad:"bing",type:"sem",searchwd:["q"],bf_searchwd:["pq"]},{clue:"120ask",ad:"120ask",type:"sem"}],in30Minutes=1/48;$(document).ready(function(){mantis.requestChat=globalRequestChat,window.console=window.console||function(){var e={};return e.log=e.warn=e.debug=e.info=e.error=e.time=e.dir=e.profile=e.clear=e.exception=e.trace=e.assert=function(){},e}(),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var i,n;if(null==this)throw new TypeError(" this is null or not defined");var a=Object(this),s=a.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(i=t),n=0;s>n;){var o;n in a&&(o=a[n],e.call(i,o,n,a)),n++}}),mantis.title=document.title,mantis.referer=document.referrer;try{mantis.referer=fake?"https://m.baidu.com/baidu.php?sc.Kf0000jA5uApXoP2Pbcw4hNdXCKt4L2MDcLW6AK7txpcO1Bt1F9MMrvImY3VnawJaTKEZ69mTIjPPhOWXBPFBuSTVgJc41yi8PJq7Te6y2210dqvG2Rv0MCdUqOQFj8TPYbyCZLuuLHjukUIrbfhxaL8kLY-bf3PhDQBnxRtIm73Ixk2ys.7Y_iF8syu52PSNeQbLmDfgLfpU3cUC7BmEvgyI--OWzs34-9h9mlU2er26.U1Y10ZDq1O8LsQhb_t12GoACEe1nqU1S0A7bTgbqdqiOEQACsOEnqU1S0A7bTgfqn6KspynqnfKY5IxREezOEnoR15ytO6KGUHYvPH00u1dLugK1n0KdpHY0TA-b5Hc30APGujYzPHf0UgfqnW0vn-tknjDLg1csPH7xnH0krfKopHYs0ZFY5HRLPsK-pyfqn10sn0KBpHYznjuxnW03g1nsr7tznj0sn-tznj0vnsKVm1Y1n1TsPWmsPHwxP1mvnHf3PHnsg1cYrHfknHnLg1TvPWD1PjDvP0KkTA-b5H00TyPGujYs0ZFMIA7M5H00mycqn7ts0ANzu1Yz0ZKs5H00UMus5H08nj0snj0snj00Ugws5H00uAwETjYk0ZFJ5H00uMfqn6KspjYs0Aq15Hc0mMTqP0K8IjYk0ZPl5fKYIgnqnHTLPHb1rjmkrjbznWn1rjDdn6Kzug7Y5HDdn1cYrHTLnj0vrH00mv6qUZNxuhn0IZRqPjc3nW6srfK15ynLPWn3rjDLujRsmHKhn1T0IAYqn0KWuWYk0ZFB5HD0UZNopHYk0AP8IA3qmW9bnjfsmWIxmLKz0ZP1TjYz0ZP1Tjcqn0KYIZ0qnsKbIZ0qn6KGIAYqn0K9uAP_mgP15H00myw35H00TvwogLmqnfKLpHYY0Au1mv9VujYz0Zwb5H00ug9spyfqPW61Pdt4Pjcdg1bdnH-xrHR1P7t4PHRzg1bdP1KxrHRLn-t4PHTLg1bdrjIxrHR4n7t4PHb40ZNzUjdCIZwsrBtEPAFbmWw9QidBrAfsPjKBPz4WUvYE0ZPGujY3PAubmvuBm1DsuADdP10d0AP1UHdArH7KfH9APWNawWcYfYcd0A7W5HD0TA3qn0KkUgfqn0KkUgnqn0KlIjYs0AdWgvuzUvYqn7tsg1Kxn0Kbmy4dmhNxTAk9Uh-bT1Ysg1Kxn7ts0ZK9I7qhUA7M5H00uAPGujYs0ANYpyfqQHD0mgPsmvnqn0KdTA-8mvnqn0KkUymqn0KhmLNY5H00uMGC5H00uh7Y5H00XMK_Ignqn0K9uAu_myTqnfK_uhnqn0KLuMFEUHY0mLFW5HD3P1bz&bdrank=2&qid=84fdcfbc10da5705&sourceid=1221&placeid=1&rank=8&ck=5576.35.150.1491.332.200.7.5737.12.150.1491&shh=ada.baidu.com&word=%25E8%2587%25AA%25E8%2580%2583%25E6%258A%25A5%25E5%2590%258D%25E6%259D%25A1%25E4%25BB%25B6":document.referrer}catch(e){mantis.referer=document.referrer}mantis.url=window.location.href,initMiniChat();var t=getProbeId();t?(console.info("p found"),mantis.uiPath=t,loadProbe(t,loadProbeCallBack,function(){console.error("fail to load p, try to load page parameter"),mantis.probeUsed=!1,loadPageParameter()})):(loadPageParameter(),mantis.probeUsed=!1);for(var i=0;3>i;){var n=mantis.url+"";if(mantis.url=decodeURIComponent(mantis.url),n===mantis.url)break;i+=1}$("a[mdesc*=mantis]").attr("href","javascript:void(0)"),$("area[mdesc*=mantis]").attr("href","javascript:void(0)"),$("a[href*=mantis]").attr("href",function(e,t){$(this).attr({mdesc:t,href:"javascript:void(0)"})}),$("a[href*=\\/swt]").attr("href",function(){$(this).attr({mdesc:"/mantis",href:"javascript:void(0)"})}),$("a[href*=\\/kst]").attr("href",function(){$(this).attr({mdesc:"/mantis",href:"javascript:void(0)"})}),loadInviteDiv(),$("[mdesc]").bind("click",visitorOpenChat),saveMantisId(),isMobile.any&&window.addEventListener("popstate",function(){hideChat()},!1),setupActiveTTl()});